-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ----- Exercíco 14 - instalar uma base de dados maior para trabalhar e perceber melhor o comando SELECT ------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM titles WHERE emp_no>=11500;

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- -------- AND ---------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM  titles WHERE emp_no>=11500 AND emp_no<=11510;

SELECT * FROM titles WHERE emp_no>=11500 AND title='Engineer'; 

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- -------- OR ---------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM titles WHERE emp_no>=11500 OR title='Engineer';

SELECT DISTINCT title FROM titles;

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- -------- WHERE NOT ---------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM titles WHERE NOT title='Engineer';

SELECT DISTINCT title FROM titles WHERE NOT title='Engineer';

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- -------- order by --------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM employees;

SELECT * FROM employees ORDER BY birth_date; ------ vai trazer todos os registros por ordem de aniversário

SELECT * FROM employees ORDER BY birth_date DESC;  ------- por defeito ele coloca de forma descendente

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------- Exercício 15 ---------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM titles ORDER BY title DESC;

SELECT * FROM titles ORDER BY title DESC LIMIT 5;  ------ assim colocamos limite na ordem

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------- Exercício 16 ---------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM departments ORDER BY dept_name ASC LIMIT 5; ------- ascendente com limite de cinco

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Função MIN -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT MIN(birth_date) FROM employees; ------- aparece apenas a dataa

SELECT MIN(birth_date), first_name FROM employees; ------- aparece a dataa e o nome

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Função MAX -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT MAX(birth_date) FROM employees;

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Função COUNT -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT COUNT(*) FROM departments;

SELECT COUNT(*) FROM salaries WHERE salary>100000;

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Exercício 17 -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT COUNT(title) FROM titles WHERE title='Engineer';

SELECT COUNT(title) FROM titles WHERE title='Engineer' AND to_date='9999-01-01';

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Função AVG -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT AVG(salary) FROM salaries; ------ saber a média dos salários

SELECT AVG(salary) FROM salaries WHERE to_date='9999-01-01'; ---- saber a média dos salários que trabalham na empresa

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Função SUM -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT SUM(salary) FROM salaries WHERE to_date='9999-01-01'; ------ saber a soma de todos os salários que trabalham na empresa

-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- ------ Operador LIKE -------
-- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT * FROM employees WHERE first_name LIKE 'b%'; ------ vai buscar todos os nomes que começam por B

SELECT * FROM employees WHERE first_name LIKE 'b%' AND last_name LIKE '%s'; ------ vai buscar todos os primeiros nomes que começam por B E QUE o último nome que termine por S 

SELECT * FROM employees WHERE first_name LIKE 'b%' OR last_name LIKE '%s'; ------ vai buscar todos os primeiros nomes que começam por B E TODOS os últimos nomes que terminem por S

SELECT * FROM employees WHERE first_name LIKE 'b%' AND last_name LIKE '%s' AND gender='M'; ------ vai buscar todos os primeiros nomes que começam por B e o último nome que termine por S que são doo sexo masculino

 
